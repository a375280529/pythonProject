from spyne.application import Application
from spyne.decorator import rpc
from spyne import ServiceBase, String
from spyne.protocol.soap import Soap11
from spyne.server.wsgi import WsgiApplication
from wsgiref.simple_server import make_server


class Test(ServiceBase):
    @rpc(String,  _returns=String)
    def get_data(self, post_data):
        return post_data if post_data else ""

    @rpc(String, _returns=String)
    def get_datadb(self, post_data):
        return '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><urn:doServiceResponse xmlns:urn="webservice.frame.dcits.com"><return>&lt;?xml version="1.0" encoding="GBK"?&gt;&lt;service xmlns="http://www.chinatax.gov.cn/spec/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.chinatax.gov.cn/spec/"&gt;&lt;head&gt;&lt;tran_id&gt;yshd.service.cxssxx&lt;/tran_id&gt;&lt;channel_id&gt;&lt;/channel_id&gt;&lt;tran_seq&gt;lssztsxt95f0499eb2f711b8a4b3086c&lt;/tran_seq&gt;&lt;tran_date&gt;&lt;/tran_date&gt;&lt;tran_time&gt;&lt;/tran_time&gt;&lt;expand&gt;&lt;name&gt;identityType&lt;/name&gt;&lt;value&gt;SZZSYH&lt;/value&gt;&lt;/expand&gt;&lt;/head&gt;&lt;body&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;TaxSession&gt;&lt;RtnState&gt;&lt;RtnCode&gt;0000&lt;/RtnCode&gt;&lt;RtnMsg&gt;&lt;Code&gt;2000&lt;/Code&gt;&lt;Message&gt;成功&lt;/Message&gt;&lt;/RtnMsg&gt;&lt;/RtnState&gt;&lt;RtnCont&gt;04AB90D9DEC4E87E08139945443B837490A818DC3203554A863CD7BD0E6C1B2EF06F8135D447190B91630A7EE9ADC246EABD320B22DF5AF255A18D23DF1E0ED0FE327CFAF301F635128CB4BAAEAC2299D01D488D1856A4F482BF66390BCB7C147EB609A1B544E6D8BCC66CC9AAB2BFB3514BF110A3A38F3EBB122D562AE8D21481C792F62F655D0649C7950BAC9BE23E693DC85776B727189F7621ED32C07B7E9A9D7F81945C4E022551D016E984A2A5FA178451B82598B182307F15417AF6547C0F7A7E13B1257661BBB1AC9CBB9739AB0A6904C77BDCAF91D583706F8F969A8C90C10DF64251CC93B493A0B1B22C35B3D8E0F39C56192A8CA94EA4A42599F1057ED04A72C3472605C906EF7DBF0A515A5AF625D7B3C965CD4D580EC0310042184321DA85C7A2764E20526F61DA999DC085591D2535D19DCD30A9F21A69CFDCDFE38010D7489886D449A522ECF1E46471CF4EBD1BF6617DFF3B52F541098DBA56426C4C4A8A3A469F1FCD6E2F15443979CB2807E0E84E0D525433C9D4CF6BB8885BC51C6C8A4CCA4C677A2CA1F3B19884A70EF34DE7D2015745993990450853996979F00A8C8F30F750740900C02DB637A41E1AB0184114C4CF210FA576E2EC0DA65D63B8069707D1633358B00AD8284E8A0CFEFCCAFA1E68933E39B50B29F49ADBFBD5D1E0CBBDAF727DAE27CD37A4667E5E27E6E9D8B671C894DD20495174AEA764277EB8DFCC61479B7D9A916EEF0D020BD076EA187E5CDE6311262CD9EB530EBC767DB142E293427505EF8F0F4FB93BACAA9521EC988D364C4CDDD77CDF7E0F2599EE9E7098498ECC096942BE8738F5DE07275AD8791B3DA454429198ADBE9A6A2F20D767F9A0BAD605361FD3E038ADC67D59D26F24E81D077EFF1F258E03D57E6FA188FD6146EBADFCCAE913FC5C796C03525AC4E0855FC20999B2507F7D4FAA9B6A05C1AB51752E9551933DB45360B26A209C6FFDA5C89876DA814DFD2709C0027684900E7335B22937E7AF76F4E3E79041B7D128C180B01EB20FD0C4BC2AF39C07BC78C60BFB25C51D5B36F138532AA554E433CDA8D1A15687DA274F2A57E5E83EB5F5EBE7CCFAA73D447180F16544E78228DAED7C7BDDD42CC8998B9CEBCA7DCD3D576DBDDFEC650AE95AC213971F47BE7AEF18761B6BABBDA9723E4426E3DD98355A3F69F5700AFAEB445549EC0E27C4C882F6BA8F07D0728CAD5EE8C1E93C1A88D2657324A5E27226C5DA2FA30C49FFD1EC3488730F04C669252BE1472AAD3FB4F4097B0DDD1A3FC5205824401756CA7C0EB8546813F23635E5CA78D49E70936B4C5A4727404A49FB91D3EFD5EF202B4BE6F7D1D2BE471B959BC989A07FCBD9EF6AE52B98D34B8CACF3F4C68BA3D6843C6C819C959A62E453282950AACA0FDCBECC1A0AC9473590B0CDAEFFACAE01942D3D9401869C2745DDC714A60211393210061C1C3E1F9311DD3D2D2774BA7200804EB8BFA12F7DE9763D824D63B02AC68E186638A9B415F47B2494B89EA910B8A19EFA1BB2B9C0674AF24E981F3DCFF7FFA00DBA162515869581AE8F12B794CFDE55E4FB40809469D0E4F99D5B5B242DADF49C6B91898F33A3D388B90F68E851DEBACA872F36C259964830F22DFD0CF1B1EA14277BC18796BDA4082F7196970C135ACD9DBB07E9C7DE5453C510B3E82593F2E8EBB49CD9887DED5C21C14D013DD93D9FD35BCA150E9E5C8CC439DDC0D2A55DA4E125E313CC4C1AB15DF5CCA7B7E0195253024AB6AA15169BF79A080CA5BAFD12849BE298E215AE7668232111127E54E0536F4495F232CADB61AB18E51ACC74A8067E37F34470C77EEC203B4BD05394B4D8E86EFA6AA84EDD02454A2CBD9EF88ED3E1C26170D4EB387FF5E93F75EC8C64D2A5BB5685C5D360C2B2022B49E1630B1CD48CBB3E146A6483E36EEFD76D4F574094AFD9B4AC9CB4C2DA1A10FECFC5F4D0ABC9376A51D20B01EEAA26F175BA6A998009C3DE399B906DBB5BC22491979F5516B23FEDCF4D36013D99CC059BC7107670B3FEE819C3E866602DFEC9474ED13E2C89C09A43144AD28931C93C425BA154FEADE43F694252A411955574F26C8109A8900BEB04EE0A7498B0F5A23B7BEA0CE731B8F61592ED216B4E11879D99B81FD5543E5B0611E83129C0A9A4D0DBEE9155865A9FF306289F30E584A69816E420399B6AE41421777BADBDCE3F0EBA855D6932C96C0BF71E823B44EC8873128834DBCE6C52848898B83BEA25DD969C0031A3ECD52F251370FCA8F6B3A79B8B84AEFC525A3F296D2931DB663ADD8BF27AA3BB41E4BABE9562C8CEA365BFD82F389E88DD84811D7526775ED426BCF277114EE3076B8425DD70A897D0A5F85A77645F19364698148133805F99D638F4A757F929D63D36CDFB04DC689F2AF4C61EA642D72A93E9FCEFE7C8DB8A8BF8D7E9EA7E900E5DFA35575A50E692765E05EE1EF67B3FCC3FEC6DC9C8BC1C77BADB9169326B4A0B29E2425EDC11B71035AB77701E4BFE548CFD956538B9BB154AD46850ADA57A3D3EBB9259675569EADB481059936008EE2C989876267A60F7E095CE32C388FB6B9289F22E753FDF4C633D8C850B45836A1EBD06009460D4E75129487A8F43ECAFEE3B5A816BA2C008DC02F175E49ED12A88628EE795B38DD712C4232A36E35CE7E5D315F908A7505599CAAA2FFC20367AFC970ACB9D77A190319E4AA97EDD047AF268E1B0DC44D58FC2FDAE4D8EF4CA35F13DD44C213195CE80C080E9C14D355729534E40CDFA9D4145FD6A1C493BD53270FF70505E17F91FBCEB43FD89A1BA6C1404882B1366BB090044E7AE305B104877132A3B99CFA0F2396093E176A671B245729C667CA25949EC9BBD8C0E7F26C1BEF44D1FFBAA346CE5160CF2EF296F55FA47B7175187EB2F9E325363BAD1C3C915F2FAFA53CC59C773D69A34E2F453CF2ED106707AC792E2BD7A350BF43855B73FFB7597CFED344E877811936B41D812AA1992F8DA4F96F6341EF81CD14D9FEEAA96467498B6FE3EE49EC2818347B8D75D9DD3769EC1CCAC0C7D2F4A639D287EA4E075C72EBCA57A53C6FB59FBCE571B019EA9C149A796980EF5FDF8A31873E8372DF77D73EFBEC446BB7638B5B9977A8F8C14F7DBCE98A6D4DD9F526447CF38F73281369D02C1026E356CE54BE84F499D9F81F25A147E8FD66D251C9E2F7405BA1E89F60E9E2E67BD1BA1193E9782F9C26B231010F384A35AEDE7DC8DD956DC429109954E41297B47818853DFA4D4AB2231F24B4B052D6FB36D9871B385284AC5976C35EFE2F31FECB24BAC7B61F8DF3DE96F91EE7659E858B53B73E073B34B8D148B503A6B281AE8F4429F60439F0C99728B4323F816A23B7C06CC06134B223012E811CF05F628122959F3D55FC086FE3919597695F909CAF3672BD7BEF2DDBA1A7529C67CB15407C82B6A37B6EE7F63372091114959B443E63630CA46F8A3AE51E8264181A5229B1C4752EC6C680FBC26D54439F6583A15F58C308AF7A21A7EB8A1D2A3B0CB30346ECE9F9409B0BD9D65937F299CA64B991288774C9DACC40D59148DE46412842D1C7AB71E01D656AE33FC179F15CCB34CA9C73D17CFD615C76E94F63CDA028A3AB098A6596C73B96BC96F50BB8F1E70DD8E75BE2907EA0E6982808E2B72D76BE6939E7676F11460948E6A6E86CF6D27EEA597552E4F33A61B15C62B04B8E8A30B03C89913AEF9B26D05DFDB3A013083DD159CD488E5DEDEDF312118BCA2FA32EA170314E8C45366F6D333475CE4651FB8226C84497D32707B5AFE4F5AF5804237634125AA3F99663A346BF05E07DBFE86B6&lt;/RtnCont&gt;&lt;/TaxSession&gt;]]&gt;&lt;/body&gt;&lt;/service&gt;</return></urn:doServiceResponse></soap:Body></soap:Envelope>'


app = Application([Test], 'http://schemas.xmlsoap.org/soap/envelope',in_protocol=Soap11(validator='lxml'), out_protocol=Soap11())
wsgi_app = WsgiApplication(app)


if __name__ == '__main__':
    server = make_server('0.0.0.0', 8080, wsgi_app)
    server.serve_forever()